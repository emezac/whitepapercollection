高频交易策略之：三角套利（triangular arbitrage)

在所有的高频交易中，外汇互换和即期外汇是所占份额最大的。外汇的高流通性和低手续费，为高换手率和极短持仓的高频策略提供了可能性。作为外汇高频的最原始策略之一，三角套利是不得不提的。这里我就和大家分享一下我对三角套利（triangular arbitrage)在加密货币市场高频交易中的理解。（数字货币可以理解成外汇市场的一种货币）

所谓三角套利，是一种引入三种货币的套利手段。它利用三种外汇对合理交叉汇率的暂时性偏离来实现套利。理论上，如果我们拥有很低延迟（low latency)的下单平台，并且可以获得较低的买卖价差（spread），那么我们有机会实现无风险套利。

一个简单的例子

先举一个加密货币的例子吧：为了方便理解，我们在这里不考虑买卖的价差（bid-ask spread）和报价无法成交的情况。如果我们可以获得如下三个报价，我们有无风险套利的机会吗？
1. 17432  CNY/BTC
2. 0.1774 BTC/BCH
3. 2766   CNY/BCH

答案是有的。以下是我们的套利步骤：

1. 观察CNY/BCH实际交叉汇率（cross rate) 2766  CNY/BCH
2. 观察CNY/BCH合成交叉汇率（Synthetic cross rate） = 17432 * 0.1774 = 3092 CNY/BCH
我们发现了实际交叉汇率不等于合成交叉汇率，套利机会存在。
3. 假设我们有2766CNY，我们做以下三步交易：
- 将2766CNY转化成1BCH
- 将1BCH转化成0.1774BTC
- 将0.1774BTC转化成3092CNY
4. 我们获得了3092 - 2766 = 326CNY的无风险收益。


让我们再来看一个核心的概念：

合成交叉汇率(Synthetic cross rate)和其价格的偏离
由于大部分的外汇对是基于CNY的（比如BTC/CNY, BTC/CNY)，我们把不以CNY为基础货币的外汇对称为交叉外汇对（比如BTC/BCH)。然而，基于对低流动性和市场冲击的考虑，很多机构投资者无法直接大量购买交叉外汇对，于是他们会使用一种合成的方法：
CNY/BCH = CNY/BTC * BTC/BCH
由于CNY/BTC 和 BTC/BCH有着很大的流通性，因此他们很容易的通过这个合成公式获得了对CNY/BCH的仓位配置。由于外汇市场的高流通性，市场在大部分时间是有效的，因此合成价格应该等于市场价格。然而，市场有时会处于短暂的失衡，使得交叉货币对的市场价格和合成价格发生偏离。当这种偏离足够抵消我们的交易成本时，我们便可使用三角套利的方法实现无风险利润。

三角套利策略

此策略利用交叉外汇对的市场价格与其合成价格的价差来实现套利。还以BCH,BTC和CNY为例：
1. 我们关注三个交易对：CNY/BTC,BTC/BCH,以及CNY/BCH.
2. 计算CNY/BCH的的合成买价（bid）和卖价（ask）：
CNY/BCH(synthetic,bid) = CNY/BTC(market,bid) * BTC/BCH(market,bid)
CNY/BCH(synthetic,ask) = CNY/BTC(market,ask) * BTC/BCH(market,ask)
3. 若此时CNY/BCH的合成买价（bid）大于其市场卖价（ask），我们采取买入市场CNY/BCH并同时卖出合成的组合的策略。这里，我们仅持仓很短时间至CNY/BCH合成与市场价格一致平仓获利。由于价差（spread）开支一直存在，我们应保证合成价格与市场价格差额要足够大，以至于可以覆盖CNY/BTC,BTC/BCH的spread，同时保证三组汇率需要同时采样。

结语
在实际操作中，这个策略对交易的设备和速度有着严格的要求。伴随着交易的电子化和自动化，各市场的价差已几乎不可能长期存在，因此价格的偏离只会存在于极短的时间内。因此，这需要交易者能够获得很低的延迟和交易费用。否则，三角套利只能停留于理论层面。